<!DOCTYPE html>
<html>
  <head>
    <title>Movement Prediction Experiment</title>
    <!-- <script src="render.js"></script> -->
    <script src="render_test.js"></script>
    <script src="webgl-utils.js"></script>
    <script src="gl-matrix.js"></script>
    <script src="jspsych-6.1.0/jspsych.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-html-button-response.js"></script>
    <script src="jspsych-6.1.0/plugins/perceptual-movement-prediction.js"></script>
     <link href="jspsych-6.1.0/css/jspsych.css" rel="stylesheet" type="text/css"></link>
  </head>
  <body>
  </body>
  <script>
        function setupCanvas() {
            var canvas_l = document.createElement('canvas');
            var canvas_r = document.createElement('canvas');
            canvas_l.setAttribute('id', 'glcanvas_l');
            canvas_l.width = 440;
            canvas_l.height = 480;
            canvas_l.setAttribute("z-index", 9999);
            document.getElementById('jspsych-content').appendChild(canvas_l);

            canvas_r.setAttribute('id', 'glcanvas_r');
            canvas_r.left = 450;
            canvas_r.width = 440;
            canvas_r.height = 480;
            canvas_r.setAttribute("z-index", 9999);
            document.getElementById('jspsych-content').appendChild(canvas_r);
        }
        function trial_txt_to_array(trial_txt){
            str_data = loadFile(trial_txt).split('\n').slice(1);
            data = [];
            for (j = 0; j < str_data.length; ++j){
                data.push(str_data[j].split(";").map(parseFloat));
            }
            return data;
        }
        
        var timeline = [];
        var trial = {
            type: "perceptual-movement-prediction",
            stimulus: trial_txt_to_array("bvh/generated/model(vcgpdm)-dataset(walking)-mode(ELBO)-parts(1)-dyn(27)-lvm(24)-hold(3)/final-lines.txt"),
            on_start: setupCanvas 
        }
        timeline.push(trial);
        jsPsych.init({
            timeline: timeline,
            show_progress_bar: true,
            auto_update_progress_bar: false
        });
  </script>